@page "/nl-to-sql"
@rendermode InteractiveServer
@inject NlToSqlService NlToSqlService

<h3>Natural Language to SQL</h3>
<input @bind="userInput" placeholder="Enter your question..." />
<button @onclick="Convert" disabled="@isLoading">
    @if (isLoading)
    {
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        <span class="visually-hidden">Loading...</span>
    }
    else
    {
        <span>Convert</span>
    }
</button>

@if (isLoading)
{
    <div class="mt-2 text-primary">
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        Processing...
    </div>
}

<p>SQL Output:</p>
<pre>@sqlOutput</pre>

@code {
    private string userInput;
    private string sqlOutput;
    private bool isLoading = false;

    private async Task Convert()
    {
        isLoading = true;
        sqlOutput = string.Empty;
        try
        {
            sqlOutput = await NlToSqlService.ConvertToSqlAsync(userInput);
        }
        finally
        {
            isLoading = false;
        }
    }
}
